import{r as d,u as g,j as t,Y as y}from"./app-49175470.js";import{G as C}from"./GuestLayout-f7c72611.js";import{f as b}from"./formatoChat-ba6bae56.js";import{C as v}from"./ChatInput-65d28841.js";import{u as w}from"./useQuery-2a1571e2.js";import"./zod-c844a60c.js";import"./Modal-dbdfde08.js";import"./dialog-6652f9e5.js";import"./transition-db21e553.js";import"./Input-3d35d492.js";import"./index-be8e88db.js";import"./Dropdown-bc2a0d01.js";import"./Select-e998b098.js";import"./Dropzone-94b97c74.js";import"./TextArea-7cc350fd.js";import"./ModalForm-9c80ff7b.js";const N=({id:r})=>{const n=async()=>{const o="/chat/"+r;return(await fetch(o,{headers:{Accept:"application/json"}})).json()},{data:a,isLoading:c}=w({queryKey:[`chat.${r}`],queryFn:n,refetchInterval:!1});return{data:a,isLoading:c}},j=({id:r})=>{var u,x,f;const[n,a]=d.useState(!1),c=g(),o=d.useRef(),{data:p,isLoading:I}=N({id:r}),s=p,h=e=>{a(!0),axios.post("/send/message",{contenido:e,mascotaId:s.mascota.id}).then(l=>{c.setQueryData([`chat.${r}`],i=>{const m=structuredClone(i.mensajes);return m.push(l.data),{...i,mensajes:m}})}).catch(l=>{console.log(l)}).finally(()=>{a(!1)})};return d.useEffect(()=>{var e;(e=o==null?void 0:o.current)==null||e.scrollIntoView({behavior:"smooth"})},[s==null?void 0:s.mensajes]),t.jsxs(t.Fragment,{children:[t.jsx(y,{title:"Chat con "+((u=s==null?void 0:s.person)==null?void 0:u.nombre)}),t.jsxs("div",{className:"px-12 w-full flex flex-col xl:items-center h-full",children:[t.jsx("h1",{className:"text-xl font-bold text-gray-700 mb-2",children:(x=s==null?void 0:s.person)==null?void 0:x.nombre}),t.jsxs("div",{className:"overflow-y-auto flex-1 flex flex-col gap-5 w-full md:w-1/2 pb-2",children:[(f=s==null?void 0:s.mensajes)==null?void 0:f.map(e=>{var l,i;return t.jsx("div",{className:`flex ${e.user_id!==((l=s==null?void 0:s.person)==null?void 0:l.id)?"flex-row-reverse":""}`,children:t.jsxs("div",{className:`pr-20 pl-2 py-2 text-white rounded-xl ${e.user_id!==((i=s==null?void 0:s.person)==null?void 0:i.id)?"bg-gray-300":"bg-blue-300"}`,children:[t.jsx("p",{className:"text-lg",children:e==null?void 0:e.contenido}),t.jsx("p",{className:"text-xs",children:b(e==null?void 0:e.created_at)})]})},e==null?void 0:e.id)}),t.jsx("div",{className:"flex-1",ref:o})]}),t.jsx(v,{disabled:n,onSendMessage:h})]})]})};j.layout=r=>t.jsx(C,{children:r});export{j as default};
