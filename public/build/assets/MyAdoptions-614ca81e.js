import{r as f,j as s,a as I,y as M,Y as L}from"./app-0e80d3ae.js";import{S}from"./Select-e1602ee8.js";import{D as P}from"./Dropzone-8f0dc6c7.js";import{I as v}from"./Input-0efc5f8c.js";import{T}from"./TextArea-bbd5ce0a.js";import{M as _}from"./ModalForm-d2c92ee2.js";import{z as o,u as G,t as k}from"./zod-cf63341f.js";import{_ as E}from"./index-4ac6d278.js";import{S as j}from"./sweetalert2.esm.all-dd0c4ce7.js";import{P as V}from"./PetCard-658246a4.js";import{G as z}from"./GuestLayout-00bbf4ac.js";import"./dialog-675031af.js";import"./transition-a27f3241.js";import"./Carousel-cf27f3e1.js";import"./Modal-a5173bac.js";import"./Dropdown-3ade979b.js";/* empty css                */const H=o.object({imagenes:o.array(o.instanceof(File)).min(1,{message:"Debes subir al menos 1 imagen"}).max(5,{message:"No puedes subir más de 5 imágenes"}).refine(t=>t.every(n=>n.size<=5*1024*1024),{message:"Cada archivo debe ser menor a 5 MB"}).refine(t=>t.every(n=>["image/jpeg","image/png","image/gif"].includes(n.type)),{message:"Solo se permiten archivos JPEG, PNG o GIF"}).optional(),deletedImages:o.array(o.number().int().positive()).optional(),tipo_id:o.enum(["1","2"],{errorMap:()=>({message:"Selecciona un tipo válido"})}),sexo:o.enum(["Macho","Hembra"],{errorMap:()=>({message:"Selecciona un tipo válido"})}),edad:o.coerce.number().min(1,{message:"La edad debe ser mayor a 0"}).max(100,{message:"La edad máxima es 100 meses"}),peso:o.coerce.number().min(1,{message:"El peso debe ser mayor que 0"}),descripcion:o.string().min(10,{message:"La descripción debe tener al menos 10 caracteres"}).max(280,{message:"La descripción no puede tener más de 280 caracteres"})});function O({open:t,onClose:n,adoption:e}){const{register:c,handleSubmit:b,setValue:i,watch:m,reset:h,getValues:w,formState:{errors:d,isSubmitting:u}}=G({mode:"onChange",resolver:k(H)}),p=m("imagenes"),[y,C]=f.useState([]);f.useEffect(()=>{var r;e&&(i("sexo",e==null?void 0:e.sexo),i("tipo_id",(r=e==null?void 0:e.tipo)==null?void 0:r.id),i("edad",e==null?void 0:e.edad),i("peso",e==null?void 0:e.peso),i("descripcion",e==null?void 0:e.descripcion),i("deletedImages",[]),C(e==null?void 0:e.imagenes))},[e]);const A=f.useMemo(()=>[...y||[],...p||[]],[p,e,y]),B=r=>{const a=new FormData;a.append("_method","patch");for(const l in r)if(r.hasOwnProperty(l)){const g=r[l];if(g instanceof Array)for(let x=0;x<g.length;x++)a.append(l+"[]",g[x]);else a.append(l,g)}I.post(`/dar-adopcion/update/${e==null?void 0:e.id}`,a,{headers:{"Content-Type":"multipart/form-data"}}).then(()=>{E.success("Adopción registrada"),h(),n(),M.reload()}).catch(()=>{E.error("Ocurrió un error")})},F=()=>{h(),C([]),n()},N=()=>{b(B)()},D=r=>{if([...p||[]].some(a=>a.name==r)){const a=[...p].filter(l=>l.name!==r);i("imagenes",a,{shouldValidate:!0})}[...y||[]].some(a=>a.id==r)&&j.fire({title:"Eliminar imagen",text:"¿Quieres eliminar esta imagen?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, eliminar!",cancelButtonText:"Cancelar"}).then(a=>{if(a.isConfirmed){const l=[...y].filter(x=>x.id!==r);C(l);const g=w("deletedImages");i("deletedImages",[...g,r])}})},q=f.useCallback(r=>{const a=[...p||[],...r];i("imagenes",a,{shouldValidate:!0})},[p]);return s.jsx(_,{title:"Editar información de adopción",show:t,closeable:!1,onClose:n,description:"Completa la información de la mascota que deseas dar en adopción",primaryAction:N,secondaryAction:F,primaryLabel:"Enviar",secondaryLabel:"Cancelar",children:s.jsxs("form",{className:"space-y-6 px-5",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(S,{id:"tipo_id",className:"mt-1 block w-full",label:"Selecciona el tipo de tu mascota",required:!0,autoComplete:"tipo",errors:d.tipo_id,disabled:u,register:c,options:[{id:"1",nombre:"Perro"},{id:"2",nombre:"Gato"}]}),s.jsx(S,{id:"sexo",className:"mt-1 block w-full",label:"Selecciona el sexo de tu mascota",required:!0,autoComplete:"sexo",errors:d.sexo,disabled:u,register:c,options:[{id:"Macho",nombre:"Macho"},{id:"Hembra",nombre:"Hembra"}]}),s.jsx(v,{id:"edad",label:"Edad",required:!0,type:"number",errors:d.edad,disabled:u,register:c}),s.jsx(v,{id:"peso",label:"Peso",required:!0,type:"number",errors:d.peso,disabled:u,register:c})]}),s.jsx(T,{id:"descripcion",label:"Descripción",required:!0,type:"text",errors:d.descripcion,disabled:u,register:c}),s.jsx(P,{uploadImages:q,removeImage:D,images:A,errors:d.imagenes,isDisabled:u})]})})}const $=({mascotas:t})=>{const[n,e]=f.useState(!1),[c,b]=f.useState(null);console.log(t);const i=m=>{j.fire({title:"Eliminar mascota",text:"No podrás revertir esto!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, eliminar!",cancelButtonText:"Cancelar"}).then(h=>{h.isConfirmed&&I.delete(`/adopcion/eliminar/${m}`).then(()=>{j.fire({title:"Eliminado!",text:"La adopción ha sido eliminada.",icon:"success"}),M.reload()}).catch(()=>{j.fire({title:"Error!",text:"Algo salió mal.",icon:"error"})})})};return s.jsxs(s.Fragment,{children:[s.jsx(L,{title:"Mis mascotas"}),s.jsx(O,{open:n,onClose:()=>{e(!1),b(null)},adoption:c}),s.jsxs("div",{className:"p-12 mt-10",children:[s.jsx("p",{className:"text-xl font-bold text-gray-700 my-5",children:"Mis mascotas"}),s.jsx("div",{className:"grid sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-2 xl:grid-cols-3 gap-3",children:t.map(m=>s.jsx(V,{mascota:m,type:"private",editFunction:()=>{e(!0),b(m)},deleteFunction:()=>i(m.id)},m.id))})]})]})};$.layout=t=>s.jsx(z,{children:t});export{$ as default};
