import{j as e,a as M,y,q as E,r as L,A as z,D as R,b as P}from"./app-1232777b.js";import{u as S,t as A,z as t}from"./zod-f39d316b.js";import{M as q}from"./Modal-4c44f10d.js";import{I as w}from"./Input-c7792e37.js";import{_ as v,I as V}from"./index-c96e2231.js";import{A as $,D as x}from"./Dropdown-fdee1dac.js";import{S as D}from"./Select-a7648edf.js";import{D as I}from"./Dropzone-5bfc1712.js";import{T as G}from"./TextArea-47aa8356.js";import{M as T}from"./ModalForm-c7f8db30.js";/* empty css                */function O(){return/Mobi|Android|iPhone|iPad|iPod|BlackBerry|Windows Phone/i.test(navigator.userAgent)}const B=({text:a})=>{const r=f=>{if(O())return window.location="/auth/google";const o=600,c=600,p=(window.innerWidth-o)/2,m=(window.innerHeight-c)/2,n="/auth/google",i=`width=${o},height=${c},top=${m},left=${p}`;window.open(n,"GoogleLogin",i)};return e.jsxs("button",{type:"button",onClick:r,className:"w-full flex flex-row text-center mt-5 h-12 font-bold border border-gray-800 bg-white rounded-md cursor-pointer",children:[e.jsx("div",{className:"w-12 h-full flex justify-center items-center bg-white rounded-md",children:e.jsx("img",{src:"/imagenes/google.png"})}),e.jsx("p",{className:"w-full h-full flex justify-center items-center text-gray-950",children:a})]})},H=t.object({email:t.string().email({message:"El email no es válido"}),password:t.string().min(6,{message:"La contraseña debe tener al menos 6 caracteres"})});function W({open:a,onClose:r,action:f}){const{register:o,reset:c,handleSubmit:p,formState:{errors:m,isSubmitting:n}}=S({mode:"onChange",resolver:A(H)}),i=s=>{M.post("/login",s,{withCredentials:!0,withXSRFToken:!0}).then(d=>{c(),r(),d.data.roles[0]==="Organizacion"||d.data.roles[0]==="Administrador"?y.visit("/dashboard"):(y.reload(),v.success("Bienvenido de nuevo"))}).catch(d=>{console.log(d),v.error("Ocurrió un error")})};return e.jsxs(q,{title:"Iniciar sesión",show:a,closeable:!0,onClose:r,children:[e.jsxs("form",{onSubmit:p(i),className:"space-y-6 px-5 py-3",children:[e.jsx(w,{id:"email",label:"Correo",required:!0,type:"email",errors:m.email,disabled:n,register:o}),e.jsx(w,{id:"password",label:"Contraseña",required:!0,type:"password",errors:m.password,disabled:n,register:o}),e.jsx("button",{type:"submit",className:"w-full h-12 bg-custom-gold text-white text-center font-bold rounded-md disabled:cursor-not-allowed",disabled:n,children:"Iniciar sesión"}),e.jsx(B,{text:"Iniciar sesión con Google"})]}),e.jsxs("p",{className:"text-center text-sm text-gray-500 p-2",children:["No tienes una cuenta? ",e.jsx("span",{className:"cursor-pointer font-bold",onClick:f,children:"Registrate"})]})]})}const _=t.object({name:t.string().min(6,{message:"El nombre debe tener al menos 6 caracteres"}).max(255,{message:"El nombre no puede tener más de 255 caracteres"}),email:t.string().email({message:"El correo no es válido"}).max(255,{message:"El correo no puede tener más de 255 caracteres"}),password:t.string().min(6,{message:"La contraseña debe tener al menos 6 caracteres"})});function X({open:a,onClose:r,action:f}){const{register:o,reset:c,handleSubmit:p,formState:{errors:m,isSubmitting:n}}=S({mode:"onChange",resolver:A(_)}),i=s=>{M.post("/register",s,{withCredentials:!0,withXSRFToken:!0}).then(d=>{c(),r(),y.reload(),v.success("Bienvenido")}).catch(d=>{console.log(d),v.error("Ocurrió un error")})};return e.jsxs(q,{title:"Registrarse",show:a,closeable:!0,onClose:r,children:[e.jsxs("form",{onSubmit:p(i),className:"space-y-6 px-5 py-3",children:[e.jsx(w,{id:"name",label:"Nombre",required:!0,type:"text",errors:m.name,disabled:n,register:o}),e.jsx(w,{id:"email",label:"Correo",required:!0,type:"email",errors:m.email,disabled:n,register:o}),e.jsx(w,{id:"password",label:"Contraseña",required:!0,type:"password",errors:m.password,disabled:n,register:o}),e.jsx("button",{type:"submit",className:"w-full h-12 bg-custom-gold text-white text-center font-bold rounded-md disabled:cursor-not-allowed",disabled:n,children:"Registrarse"}),e.jsx(B,{text:"Registrarse con Google"})]}),e.jsxs("p",{className:"text-center text-sm text-gray-500 p-2",children:["Ya tienes una cuenta? ",e.jsx("span",{className:"cursor-pointer font-bold",onClick:f,children:"Inicia sesión"})]})]})}const J=t.object({imagenes:t.array(t.instanceof(File)).min(1,{message:"Debes subir al menos 1 imagen"}).max(5,{message:"No puedes subir más de 5 imágenes"}).refine(a=>a.every(r=>r.size<=5*1024*1024),{message:"Cada archivo debe ser menor a 5 MB"}).refine(a=>a.every(r=>["image/jpeg","image/png","image/gif"].includes(r.type)),{message:"Solo se permiten archivos JPEG, PNG o GIF"}),tipo:t.enum(["1","2"],{errorMap:()=>({message:"Selecciona un tipo válido"})}),sexo:t.enum(["Macho","Hembra"],{errorMap:()=>({message:"Selecciona un tipo válido"})}),edad:t.coerce.number().min(1,{message:"La edad debe ser mayor a 0"}).max(100,{message:"La edad máxima es 100 meses"}),peso:t.coerce.number().min(1,{message:"El peso debe ser mayor que 0"}),descripcion:t.string().min(10,{message:"La descripción debe tener al menos 10 caracteres"}).max(280,{message:"La descripción no puede tener más de 280 caracteres"})});function Y({open:a,onClose:r}){const{url:f}=E(),{register:o,handleSubmit:c,setValue:p,watch:m,reset:n,formState:{errors:i,isSubmitting:s}}=S({mode:"onChange",resolver:A(J),defaultValues:{imagenes:[],tipo:"1",sexo:"Macho"}}),d=m("imagenes"),k=async l=>{const g=new FormData;for(const u in l)if(l.hasOwnProperty(u)){const j=l[u];if(j instanceof Array)for(let F=0;F<j.length;F++)g.append(u+"[]",j[F]);else g.append(u,j)}try{const{data:u}=await M.post("/dar-adopcion/store",g,{withCredentials:!0,withXSRFToken:!0});v.success("Adopción registrada"),n(),r(),f!=="/myadoptions"?y.visit("/myadoptions"):y.reload()}catch(u){console.log(u)}},N=()=>{n(),r()},C=()=>{c(k)()},b=l=>{const g=[...d].filter(u=>u.name!==l);p("imagenes",g,{shouldValidate:!0})},h=L.useCallback(l=>{const g=[...d,...l];p("imagenes",g,{shouldValidate:!0})},[d]);return e.jsx(T,{title:"Dar en adopción",show:a,onClose:r,closeable:!1,description:"Completa la información de la mascota que deseas dar en adopción",primaryAction:C,secondaryAction:N,primaryLabel:"Enviar",secondaryLabel:"Cancelar",children:e.jsx("form",{className:"px-5",children:e.jsxs("div",{className:"space-y-6 overflow-y-auto",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(D,{id:"tipo",className:"mt-1 block w-full",label:"Tipo de mascota",required:!0,autoComplete:"tipo",errors:i.tipo,disabled:s,register:o,options:[{id:"1",nombre:"Perro"},{id:"2",nombre:"Gato"}]}),e.jsx(D,{id:"sexo",className:"mt-1 block w-full",label:"Sexo de la mascota",required:!0,autoComplete:"sexo",errors:i.sexo,disabled:s,register:o,options:[{id:"Macho",nombre:"Macho"},{id:"Hembra",nombre:"Hembra"}]}),e.jsx(w,{id:"edad",label:"Edad",required:!0,type:"number",errors:i.edad,disabled:s,register:o}),e.jsx(w,{id:"peso",label:"Peso",required:!0,type:"number",errors:i.peso,disabled:s,register:o})]}),e.jsx(G,{id:"descripcion",label:"Descripción",required:!0,type:"text",errors:i.descripcion,disabled:s,register:o}),e.jsx(I,{uploadImages:h,removeImage:b,images:d,errors:i.imagenes,isDisabled:s,inputText:"Presiona o arrastra imagenes de tu mascota (máximo 5 imágenes)"})]})})})}const K=t.object({imagenes:t.array(t.instanceof(File)).min(1,{message:"Debes subir al menos 1 imagen"}).max(5,{message:"No puedes subir más de 5 imágenes"}).refine(a=>a.every(r=>r.size<=5*1024*1024),{message:"Cada archivo debe ser menor a 5 MB"}).refine(a=>a.every(r=>["image/jpeg","image/png","image/gif"].includes(r.type)),{message:"Solo se permiten archivos JPEG, PNG o GIF"}),tipo:t.enum(["1","2"],{errorMap:()=>({message:"Selecciona un tipo válido"})}),sexo:t.enum(["Macho","Hembra"],{errorMap:()=>({message:"Selecciona un tipo válido"})}),edad:t.coerce.number().min(1,{message:"La edad debe ser mayor a 0"}).max(100,{message:"La edad máxima es 100 meses"}),peso:t.coerce.number().min(1,{message:"El peso debe ser mayor que 0"}),descripcion:t.string().min(10,{message:"La descripción debe tener al menos 10 caracteres"}).max(280,{message:"La descripción no puede tener más de 280 caracteres"})});function Q({open:a,onClose:r}){const{url:f}=E(),{register:o,handleSubmit:c,setValue:p,watch:m,reset:n,formState:{errors:i,isSubmitting:s}}=S({mode:"onChange",resolver:A(K),defaultValues:{imagenes:[],tipo:"1",sexo:"Macho"}}),d=async b=>{const h=new FormData;for(const l in b)if(b.hasOwnProperty(l)){const g=b[l];if(g instanceof Array)for(let u=0;u<g.length;u++)h.append(l+"[]",g[u]);else h.append(l,g)}try{const{data:l}=await M.post("/dar-adopcion/store",h);n(),v.success("Adopción registrada"),r(),f!=="/myadoptions"?y.visit("/myadoptions"):y.reload()}catch(l){console.log(l)}},k=m("imagenes"),N=()=>{n(),r(),console.log("hola")},C=()=>{c(d)()};return e.jsx(T,{title:"Reportar extravío",show:a,onClose:r,closeable:!1,description:"Completa la información de la mascota",primaryAction:C,secondaryAction:N,primaryLabel:"Enviar",secondaryLabel:"Cancelar",children:e.jsx("form",{className:"px-5",children:e.jsxs("div",{className:"space-y-6 overflow-y-auto",children:[e.jsx(D,{id:"tipo",className:"mt-1 block w-full",label:"Tipo de mascota",onChange:b=>p("tipo",b.target.value),required:!0,autoComplete:"tipo",errors:i.tipo,disabled:s,options:[{id:"1",nombre:"Perro"},{id:"2",nombre:"Gato"}]}),e.jsx(G,{id:"descripcion",label:"Descripción",required:!0,type:"text",errors:i.descripcion,disabled:s,register:o}),e.jsx(I,{setImage:p,images:k,errors:i.imagenes,isDisabled:s,inputText:"Presiona o arrastra imagenes de tu mascota (máximo 5 imágenes)"})]})})})}const U=()=>L.useContext(z),Z=U;function me({children:a}){var d,k,N,C,b,h,l,g;const{loginModal:r,registerModal:f,setLoginModal:o,setRegisterModal:c}=Z(),[p,m]=R(!1),[n,i]=R(!1),{auth:s}=E().props;return L.useEffect(()=>{const u=j=>{j.origin===window.location.origin&&j.data==="auth-success"&&(y.reload(),v.success("Bienvenido"),c(!1),o(!1))};return window.addEventListener("message",u),()=>{window.removeEventListener("message",u)}},[]),L.useEffect(()=>{p===!0&&(s!=null&&s.user||o(!0))},[p]),e.jsxs(e.Fragment,{children:[e.jsx(V,{position:"top-center",reverseOrder:!1}),e.jsx(Y,{open:!!(p&&(s!=null&&s.user)),onClose:()=>m(!1)}),e.jsx(X,{open:f,onClose:()=>c(!1),action:()=>{c(!1),o(!0)}}),e.jsx(W,{open:r,onClose:()=>o(!1),action:()=>{o(!1),c(!0)}}),e.jsx(Q,{open:!!(n&&(s!=null&&s.user)),onClose:()=>i(!1)}),e.jsxs("div",{className:"fixed flex justify-between items-center top-0 right-0 px-6 py-2 text-right z-10 bg-white w-full",children:[e.jsx(P,{href:"/",children:e.jsx($,{className:"block h-9 w-auto fill-current text-gray-800"})}),e.jsx(P,{href:"/mascotas",className:"ml-4 font-semibold text-custom-beige hover:text-gray-900 dark:text-custom-beige dark:hover:text-gray-600 focus:outline focus:outline-2 focus:rounded-sm",children:"Mascotas"}),e.jsx("a",{href:"",className:"ml-4 font-semibold text-custom-beige hover:text-gray-900 dark:text-custom-beige dark:hover:text-gray-600 focus:outline focus:outline-2 focus:rounded-sm",children:"Organizaciones"}),e.jsx("a",{href:"",className:"ml-4 font-semibold text-custom-beige hover:text-gray-900 dark:text-custom-beige dark:hover:text-gray-600 focus:outline focus:outline-2 focus:rounded-sm",children:"Contacto"}),e.jsx("button",{type:"button",className:"hidden md:block font-bold text-gray-700 border border-gray-400 p-2 rounded-full",onClick:()=>m(!0),children:"Dar en adopción"}),e.jsx("button",{type:"button",className:"hidden md:block font-bold text-gray-700 border border-gray-400 p-2 rounded-full",onClick:()=>i(!0),children:"Reportar extravío"}),e.jsx("div",{className:"hidden md:block",children:e.jsxs(x,{children:[e.jsx(x.Trigger,{children:s!=null&&s.user?(d=s==null?void 0:s.user)!=null&&d.photo?e.jsx("img",{src:(k=s==null?void 0:s.user)==null?void 0:k.photo,alt:"profile image",className:"rounded-full w-10 h-10 cursor-pointer"}):e.jsx("div",{className:"bg-blue-500 text-white font-bold flex justify-center items-center rounded-full w-10 h-10 cursor-pointer",children:(C=(N=s==null?void 0:s.user)==null?void 0:N.name)==null?void 0:C.charAt(0)}):e.jsx("img",{src:"/imagenes/blank_profile.png",alt:"profile image",className:"rounded-full w-10 h-10 cursor-pointer"})}),e.jsx(x.Content,{children:s!=null&&s.user?e.jsxs(e.Fragment,{children:[e.jsx(x.Link,{href:route("profile.edit"),children:"Perfil"}),e.jsx(x.Link,{href:route("logout"),method:"post",as:"button",children:"Cerrar sesión"}),e.jsx(x.Link,{href:"/myadoptions",children:"Mis mascotas"}),e.jsx(x.Link,{href:"/chats",children:"Mensajes"})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",className:"block w-full px-4 py-2 text-start text-sm leading-5 text-gray-700 hover:bg-gray-100 focus:outline-none focus:bg-gray-100 transition duration-150 ease-in-out",onClick:()=>o(!0),children:"Iniciar sesión"}),e.jsx("button",{type:"button",className:"block w-full px-4 py-2 text-start text-sm leading-5 text-gray-700 hover:bg-gray-100 focus:outline-none focus:bg-gray-100 transition duration-150 ease-in-out",onClick:()=>c(!0),children:"Registrarse"})]})})]})})]}),a,e.jsx("div",{className:"block md:hidden fixed bottom-0 w-full bg-white shadow-md",children:e.jsxs("div",{className:"flex justify-around py-4",children:[e.jsxs("div",{className:"flex flex-col items-center cursor-pointer",onClick:()=>m(!0),children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 7V3m8 4V3m-7 6a4 4 0 00-8 0v7h16v-7a4 4 0 00-8 0z"})}),e.jsx("span",{className:"text-xs text-gray-700",children:"Dar en adopción"})]}),e.jsxs("div",{className:"flex flex-col items-center cursor-pointer",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})}),e.jsx("span",{className:"text-xs text-gray-700",children:"Reportar extravío"})]}),e.jsxs(x,{children:[e.jsx(x.Trigger,{children:s!=null&&s.user?(b=s==null?void 0:s.user)!=null&&b.photo?e.jsx("img",{src:(h=s==null?void 0:s.user)==null?void 0:h.photo,alt:"profile image",className:"rounded-full w-10 h-10 cursor-pointer"}):e.jsx("div",{className:"bg-blue-500 text-white font-bold flex justify-center items-center rounded-full w-10 h-10 cursor-pointer",children:(g=(l=s==null?void 0:s.user)==null?void 0:l.name)==null?void 0:g.charAt(0)}):e.jsx("img",{src:"/imagenes/blank_profile.png",alt:"profile image",className:"rounded-full w-10 h-10 cursor-pointer"})}),e.jsx(x.Content,{position:"buttom",children:s!=null&&s.user?e.jsxs(e.Fragment,{children:[e.jsx(x.Link,{href:route("profile.edit"),children:"Perfil"}),e.jsx(x.Link,{href:route("logout"),method:"post",as:"button",children:"Cerrar sesión"}),e.jsx(x.Link,{href:"/myadoptions",children:"Mis mascotas"})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",className:"block w-full px-4 py-2 text-start text-sm leading-5 text-gray-700 hover:bg-gray-100 focus:outline-none focus:bg-gray-100 transition duration-150 ease-in-out",onClick:()=>o(!0),children:"Iniciar sesión"}),e.jsx("button",{type:"button",className:"block w-full px-4 py-2 text-start text-sm leading-5 text-gray-700 hover:bg-gray-100 focus:outline-none focus:bg-gray-100 transition duration-150 ease-in-out",onClick:()=>c(!0),children:"Registrarse"})]})})]})]})})]})}export{me as G,B as L,Z as u};
