import{j as r,a as F,y as L,q as A,r as C,A as oe,u as ae,D as $,b as D}from"./app-d5549e23.js";import{u as M,t as q,z as h}from"./zod-21fc237b.js";import{M as J}from"./Modal-90278108.js";import{I as N}from"./Input-de3d769c.js";import{_ as k,I as ce}from"./index-76830549.js";import{A as le,D as v}from"./Dropdown-59417614.js";import{S as Q}from"./Select-3a788152.js";import{D as Y}from"./Dropzone-ed3795da.js";import{T as U}from"./TextArea-466a9d21.js";import{M as Z}from"./ModalForm-2d4f16e9.js";function ue(){return/Mobi|Android|iPhone|iPad|iPod|BlackBerry|Windows Phone/i.test(navigator.userAgent)}const ee=({text:i,disabled:s=!1})=>{const n=t=>{if(ue())return window.location="/auth/google";const e=600,o=600,a=(window.innerWidth-e)/2,l=(window.innerHeight-o)/2,u="/auth/google",c=`width=${e},height=${o},top=${l},left=${a}`;window.open(u,"GoogleLogin",c)};return r.jsxs("button",{type:"button",onClick:n,disabled:s,className:"w-full flex flex-row text-center mt-5 h-12 font-bold border border-gray-800 bg-white rounded-md cursor-pointer disabled:cursor-not-allowed",children:[r.jsx("div",{className:"w-12 h-full flex justify-center items-center bg-white rounded-md",children:r.jsx("img",{src:"/imagenes/google.png"})}),r.jsx("p",{className:"w-full h-full flex justify-center items-center text-gray-950",children:i})]})},he=h.object({email:h.string().email({message:"El email no es válido"}),password:h.string().min(8,{message:"La contraseña debe tener al menos 8 caracteres"})});function de({open:i,onClose:s,action:n}){const{register:t,reset:e,handleSubmit:o,formState:{errors:a,isSubmitting:l}}=M({mode:"onChange",resolver:q(he)}),u=c=>F.post("/login",c).then(f=>{e(),s(),f.data.roles[0]==="Organizacion"||f.data.roles[0]==="Administrador"?L.visit("/dashboard"):(L.reload(),k.success("Bienvenido de nuevo"))}).catch(f=>{if(f.response.status===422)return k.error("Credenciales incorrectas.");k.error("Ocurrió un error")});return r.jsxs(J,{title:"Iniciar sesión",show:i,closeable:!0,onClose:()=>{e(),s()},children:[r.jsxs("form",{onSubmit:o(u),className:"space-y-6 px-5 py-3",children:[r.jsx(N,{id:"email",label:"Correo",required:!0,type:"email",errors:a.email,disabled:l,register:t}),r.jsx(N,{id:"password",label:"Contraseña",required:!0,type:"password",errors:a.password,disabled:l,register:t}),r.jsx("button",{type:"submit",className:"w-full h-12 bg-custom-gold text-white text-center font-bold rounded-md disabled:cursor-not-allowed disabled:opacity-50",disabled:l,children:"Iniciar sesión"}),r.jsx(ee,{text:"Iniciar sesión con Google",disabled:l})]}),r.jsxs("p",{className:"text-center text-sm text-gray-500 p-2",children:["No tienes una cuenta? ",r.jsx("span",{className:"cursor-pointer font-bold",onClick:n,children:"Registrate"})]})]})}const pe=h.object({name:h.string().min(6,{message:"El nombre debe tener al menos 6 caracteres"}).max(255,{message:"El nombre no puede tener más de 255 caracteres"}),email:h.string().email({message:"El correo no es válido"}).max(255,{message:"El correo no puede tener más de 255 caracteres"}),password:h.string().min(8,{message:"La contraseña debe tener al menos 8 caracteres"})});function fe({open:i,onClose:s,action:n}){const{register:t,reset:e,handleSubmit:o,formState:{errors:a,isSubmitting:l}}=M({mode:"onChange",resolver:q(pe)}),u=c=>F.post("/register",c).then(f=>{e(),s(),L.reload(),k.success("Bienvenido")}).catch(f=>{k.error("Ocurrió un error")});return r.jsxs(J,{title:"Registrarse",show:i,closeable:!0,onClose:()=>{e(),s()},children:[r.jsxs("form",{onSubmit:o(u),className:"space-y-6 px-5 py-3",children:[r.jsx(N,{id:"name",label:"Nombre",required:!0,type:"text",errors:a.name,disabled:l,register:t}),r.jsx(N,{id:"email",label:"Correo",required:!0,type:"email",errors:a.email,disabled:l,register:t}),r.jsx(N,{id:"password",label:"Contraseña",required:!0,type:"password",errors:a.password,disabled:l,register:t}),r.jsx("button",{type:"submit",className:"w-full h-12 bg-custom-gold text-white text-center font-bold rounded-md disabled:cursor-not-allowed disabled:opacity-50",disabled:l,children:"Registrarse"}),r.jsx(ee,{text:"Registrarse con Google",disabled:l})]}),r.jsxs("p",{className:"text-center text-sm text-gray-500 p-2",children:["Ya tienes una cuenta? ",r.jsx("span",{className:"cursor-pointer font-bold",onClick:n,children:"Inicia sesión"})]})]})}const me=h.object({imagenes:h.array(h.instanceof(File)).min(1,{message:"Debes subir al menos 1 imagen"}).max(5,{message:"No puedes subir más de 5 imágenes"}).refine(i=>i.every(s=>s.size<=5*1024*1024),{message:"Cada archivo debe ser menor a 5 MB"}).refine(i=>i.every(s=>["image/jpeg","image/png","image/gif"].includes(s.type)),{message:"Solo se permiten archivos JPEG, PNG o GIF"}),tipo:h.enum(["1","2"],{errorMap:()=>({message:"Selecciona un tipo válido"})}),sexo:h.enum(["Macho","Hembra"],{errorMap:()=>({message:"Selecciona un tipo válido"})}),edad:h.coerce.number().min(1,{message:"La edad debe ser mayor a 0"}).max(100,{message:"La edad máxima es 100 meses"}),peso:h.coerce.number().min(1,{message:"El peso debe ser mayor que 0"}),descripcion:h.string().min(10,{message:"La descripción debe tener al menos 10 caracteres"}).max(280,{message:"La descripción no puede tener más de 280 caracteres"})});function ve({open:i,onClose:s}){const{url:n}=A(),{register:t,handleSubmit:e,setValue:o,watch:a,reset:l,formState:{errors:u,isSubmitting:c}}=M({mode:"onChange",resolver:q(me),defaultValues:{imagenes:[],tipo:"1",sexo:"Macho"}}),f=a("imagenes"),_=async y=>{const m=new FormData;for(const x in y)if(y.hasOwnProperty(x)){const j=y[x];if(j instanceof Array)for(let B=0;B<j.length;B++)m.append(x+"[]",j[B]);else m.append(x,j)}try{const{data:x}=await F.post("/dar-adopcion/store",m);k.success("Adopción registrada"),l(),s(),n!=="/myadoptions"?L.visit("/myadoptions"):L.reload()}catch(x){console.log(x),k.error("Ocurrión un error")}},P=()=>{l(),s()},I=()=>{e(_)()},S=y=>{const m=[...f].filter(x=>x.name!==y);o("imagenes",m,{shouldValidate:!0})},w=C.useCallback(y=>{const m=[...f,...y];o("imagenes",m,{shouldValidate:!0})},[f]);return r.jsx(Z,{title:"Dar en adopción",show:i,onClose:s,closeable:!1,description:"Completa la información de la mascota que deseas dar en adopción",primaryAction:I,secondaryAction:P,primaryLabel:"Enviar",secondaryLabel:"Cancelar",disabledButtons:c,children:r.jsx("form",{className:"px-5",children:r.jsxs("div",{className:"space-y-6 overflow-y-auto",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsx(Q,{id:"tipo",className:"mt-1 block w-full",label:"Tipo de mascota",required:!0,autoComplete:"tipo",errors:u.tipo,disabled:c,register:t,options:[{id:"1",nombre:"Perro"},{id:"2",nombre:"Gato"}]}),r.jsx(Q,{id:"sexo",className:"mt-1 block w-full",label:"Sexo de la mascota",required:!0,autoComplete:"sexo",errors:u.sexo,disabled:c,register:t,options:[{id:"Macho",nombre:"Macho"},{id:"Hembra",nombre:"Hembra"}]}),r.jsx(N,{id:"edad",label:"Edad",required:!0,type:"number",errors:u.edad,disabled:c,register:t}),r.jsx(N,{id:"peso",label:"Peso",required:!0,type:"number",errors:u.peso,disabled:c,register:t})]}),r.jsx(U,{id:"descripcion",label:"Descripción",required:!0,type:"text",errors:u.descripcion,disabled:c,register:t}),r.jsx(Y,{uploadImages:w,removeImage:S,images:f,errors:u.imagenes,isDisabled:c,inputText:"Presiona o arrastra imagenes de tu mascota (máximo 5 imágenes)"})]})})})}const be=h.object({foto_mascota:h.instanceof(File).refine(i=>["image/jpeg","image/png","image/jpg","image/gif"].includes(i.type),{message:"El archivo debe ser una imagen en formato jpeg, png, jpg o gif."}).refine(i=>i.size<=2048*1024,{message:"El tamaño máximo permitido es de 2MB."}),descripcion:h.string().min(10,{message:"La descripción debe tener al menos 10 caracteres"}).max(280,{message:"La descripción no puede tener más de 280 caracteres"})});function ge({open:i,onClose:s}){A();const{register:n,handleSubmit:t,setValue:e,watch:o,reset:a,formState:{errors:l,isSubmitting:u}}=M({mode:"onChange",resolver:q(be)}),c=async w=>{const y=new FormData;for(key in w){const m=w[key];y.append(key,m)}try{await F.post(),k.success("Reporte de extravio registrado"),a(),s()}catch(m){console.log(m),k.error("Ocurrió un error")}},f=o("foto_mascota"),_=()=>{a(),s()},P=()=>{t(c)()},I=w=>{e("foto_mascota",w)},S=w=>{a("foto_mascota")};return r.jsx(Z,{title:"Reportar extravío",show:i,onClose:s,closeable:!1,description:"Completa la información de la mascota",primaryAction:P,secondaryAction:_,primaryLabel:"Enviar",secondaryLabel:"Cancelar",disabledButtons:u,children:r.jsx("form",{className:"px-5",children:r.jsxs("div",{className:"space-y-6 overflow-y-auto",children:[r.jsx(U,{id:"descripcion",label:"Descripción",required:!0,type:"text",errors:l.descripcion,disabled:u,register:n}),r.jsx(Y,{uploadImages:I,removeImage:S,images:f,errors:l.imagenes,isDisabled:u,inputText:"Presiona o arrastra imagenes de tu mascota (máximo 5 imágenes)",maxFiles:1})]})})})}const ye=()=>C.useContext(oe),xe=ye;function E(i){"@babel/helpers - typeof";return E=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},E(i)}function d(i,s){if(!(i instanceof s))throw new TypeError("Cannot call a class as a function")}function H(i,s){for(var n=0;n<s.length;n++){var t=s[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(i,t.key,t)}}function p(i,s,n){return s&&H(i.prototype,s),n&&H(i,n),Object.defineProperty(i,"prototype",{writable:!1}),i}function O(){return O=Object.assign||function(i){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(i[t]=n[t])}return i},O.apply(this,arguments)}function b(i,s){if(typeof s!="function"&&s!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(s&&s.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),s&&z(i,s)}function R(i){return R=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},R(i)}function z(i,s){return z=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},z(i,s)}function ke(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function we(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function je(i,s){if(s&&(typeof s=="object"||typeof s=="function"))return s;if(s!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return we(i)}function g(i){var s=ke();return function(){var t=R(i),e;if(s){var o=R(this).constructor;e=Reflect.construct(t,arguments,o)}else e=t.apply(this,arguments);return je(this,e)}}var V=function(){function i(){d(this,i)}return p(i,[{key:"listenForWhisper",value:function(n,t){return this.listen(".client-"+n,t)}},{key:"notification",value:function(n){return this.listen(".Illuminate\\Notifications\\Events\\BroadcastNotificationCreated",n)}},{key:"stopListeningForWhisper",value:function(n,t){return this.stopListening(".client-"+n,t)}}]),i}(),te=function(){function i(s){d(this,i),this.namespace=s}return p(i,[{key:"format",value:function(n){return[".","\\"].includes(n.charAt(0))?n.substring(1):(this.namespace&&(n=this.namespace+"."+n),n.replace(/\./g,"\\"))}},{key:"setNamespace",value:function(n){this.namespace=n}}]),i}(),G=function(i){b(n,i);var s=g(n);function n(t,e,o){var a;return d(this,n),a=s.call(this),a.name=e,a.pusher=t,a.options=o,a.eventFormatter=new te(a.options.namespace),a.subscribe(),a}return p(n,[{key:"subscribe",value:function(){this.subscription=this.pusher.subscribe(this.name)}},{key:"unsubscribe",value:function(){this.pusher.unsubscribe(this.name)}},{key:"listen",value:function(e,o){return this.on(this.eventFormatter.format(e),o),this}},{key:"listenToAll",value:function(e){var o=this;return this.subscription.bind_global(function(a,l){if(!a.startsWith("pusher:")){var u=o.options.namespace.replace(/\./g,"\\"),c=a.startsWith(u)?a.substring(u.length+1):"."+a;e(c,l)}}),this}},{key:"stopListening",value:function(e,o){return o?this.subscription.unbind(this.eventFormatter.format(e),o):this.subscription.unbind(this.eventFormatter.format(e)),this}},{key:"stopListeningToAll",value:function(e){return e?this.subscription.unbind_global(e):this.subscription.unbind_global(),this}},{key:"subscribed",value:function(e){return this.on("pusher:subscription_succeeded",function(){e()}),this}},{key:"error",value:function(e){return this.on("pusher:subscription_error",function(o){e(o)}),this}},{key:"on",value:function(e,o){return this.subscription.bind(e,o),this}}]),n}(V),ne=function(i){b(n,i);var s=g(n);function n(){return d(this,n),s.apply(this,arguments)}return p(n,[{key:"whisper",value:function(e,o){return this.pusher.channels.channels[this.name].trigger("client-".concat(e),o),this}}]),n}(G),Ce=function(i){b(n,i);var s=g(n);function n(){return d(this,n),s.apply(this,arguments)}return p(n,[{key:"whisper",value:function(e,o){return this.pusher.channels.channels[this.name].trigger("client-".concat(e),o),this}}]),n}(G),Ne=function(i){b(n,i);var s=g(n);function n(){return d(this,n),s.apply(this,arguments)}return p(n,[{key:"here",value:function(e){return this.on("pusher:subscription_succeeded",function(o){e(Object.keys(o.members).map(function(a){return o.members[a]}))}),this}},{key:"joining",value:function(e){return this.on("pusher:member_added",function(o){e(o.info)}),this}},{key:"whisper",value:function(e,o){return this.pusher.channels.channels[this.name].trigger("client-".concat(e),o),this}},{key:"leaving",value:function(e){return this.on("pusher:member_removed",function(o){e(o.info)}),this}}]),n}(ne),se=function(i){b(n,i);var s=g(n);function n(t,e,o){var a;return d(this,n),a=s.call(this),a.events={},a.listeners={},a.name=e,a.socket=t,a.options=o,a.eventFormatter=new te(a.options.namespace),a.subscribe(),a}return p(n,[{key:"subscribe",value:function(){this.socket.emit("subscribe",{channel:this.name,auth:this.options.auth||{}})}},{key:"unsubscribe",value:function(){this.unbind(),this.socket.emit("unsubscribe",{channel:this.name,auth:this.options.auth||{}})}},{key:"listen",value:function(e,o){return this.on(this.eventFormatter.format(e),o),this}},{key:"stopListening",value:function(e,o){return this.unbindEvent(this.eventFormatter.format(e),o),this}},{key:"subscribed",value:function(e){return this.on("connect",function(o){e(o)}),this}},{key:"error",value:function(e){return this}},{key:"on",value:function(e,o){var a=this;return this.listeners[e]=this.listeners[e]||[],this.events[e]||(this.events[e]=function(l,u){a.name===l&&a.listeners[e]&&a.listeners[e].forEach(function(c){return c(u)})},this.socket.on(e,this.events[e])),this.listeners[e].push(o),this}},{key:"unbind",value:function(){var e=this;Object.keys(this.events).forEach(function(o){e.unbindEvent(o)})}},{key:"unbindEvent",value:function(e,o){this.listeners[e]=this.listeners[e]||[],o&&(this.listeners[e]=this.listeners[e].filter(function(a){return a!==o})),(!o||this.listeners[e].length===0)&&(this.events[e]&&(this.socket.removeListener(e,this.events[e]),delete this.events[e]),delete this.listeners[e])}}]),n}(V),re=function(i){b(n,i);var s=g(n);function n(){return d(this,n),s.apply(this,arguments)}return p(n,[{key:"whisper",value:function(e,o){return this.socket.emit("client event",{channel:this.name,event:"client-".concat(e),data:o}),this}}]),n}(se),_e=function(i){b(n,i);var s=g(n);function n(){return d(this,n),s.apply(this,arguments)}return p(n,[{key:"here",value:function(e){return this.on("presence:subscribed",function(o){e(o.map(function(a){return a.user_info}))}),this}},{key:"joining",value:function(e){return this.on("presence:joining",function(o){return e(o.user_info)}),this}},{key:"whisper",value:function(e,o){return this.socket.emit("client event",{channel:this.name,event:"client-".concat(e),data:o}),this}},{key:"leaving",value:function(e){return this.on("presence:leaving",function(o){return e(o.user_info)}),this}}]),n}(re),T=function(i){b(n,i);var s=g(n);function n(){return d(this,n),s.apply(this,arguments)}return p(n,[{key:"subscribe",value:function(){}},{key:"unsubscribe",value:function(){}},{key:"listen",value:function(e,o){return this}},{key:"listenToAll",value:function(e){return this}},{key:"stopListening",value:function(e,o){return this}},{key:"subscribed",value:function(e){return this}},{key:"error",value:function(e){return this}},{key:"on",value:function(e,o){return this}}]),n}(V),ie=function(i){b(n,i);var s=g(n);function n(){return d(this,n),s.apply(this,arguments)}return p(n,[{key:"whisper",value:function(e,o){return this}}]),n}(T),Pe=function(i){b(n,i);var s=g(n);function n(){return d(this,n),s.apply(this,arguments)}return p(n,[{key:"whisper",value:function(e,o){return this}}]),n}(T),Ie=function(i){b(n,i);var s=g(n);function n(){return d(this,n),s.apply(this,arguments)}return p(n,[{key:"here",value:function(e){return this}},{key:"joining",value:function(e){return this}},{key:"whisper",value:function(e,o){return this}},{key:"leaving",value:function(e){return this}}]),n}(ie),W=function(){function i(s){d(this,i),this._defaultOptions={auth:{headers:{}},authEndpoint:"/broadcasting/auth",userAuthentication:{endpoint:"/broadcasting/user-auth",headers:{}},broadcaster:"pusher",csrfToken:null,bearerToken:null,host:null,key:null,namespace:"App.Events"},this.setOptions(s),this.connect()}return p(i,[{key:"setOptions",value:function(n){this.options=O(this._defaultOptions,n);var t=this.csrfToken();return t&&(this.options.auth.headers["X-CSRF-TOKEN"]=t,this.options.userAuthentication.headers["X-CSRF-TOKEN"]=t),t=this.options.bearerToken,t&&(this.options.auth.headers.Authorization="Bearer "+t,this.options.userAuthentication.headers.Authorization="Bearer "+t),n}},{key:"csrfToken",value:function(){var n;return typeof window<"u"&&window.Laravel&&window.Laravel.csrfToken?window.Laravel.csrfToken:this.options.csrfToken?this.options.csrfToken:typeof document<"u"&&typeof document.querySelector=="function"&&(n=document.querySelector('meta[name="csrf-token"]'))?n.getAttribute("content"):null}}]),i}(),X=function(i){b(n,i);var s=g(n);function n(){var t;return d(this,n),t=s.apply(this,arguments),t.channels={},t}return p(n,[{key:"connect",value:function(){typeof this.options.client<"u"?this.pusher=this.options.client:this.options.Pusher?this.pusher=new this.options.Pusher(this.options.key,this.options):this.pusher=new Pusher(this.options.key,this.options)}},{key:"signin",value:function(){this.pusher.signin()}},{key:"listen",value:function(e,o,a){return this.channel(e).listen(o,a)}},{key:"channel",value:function(e){return this.channels[e]||(this.channels[e]=new G(this.pusher,e,this.options)),this.channels[e]}},{key:"privateChannel",value:function(e){return this.channels["private-"+e]||(this.channels["private-"+e]=new ne(this.pusher,"private-"+e,this.options)),this.channels["private-"+e]}},{key:"encryptedPrivateChannel",value:function(e){return this.channels["private-encrypted-"+e]||(this.channels["private-encrypted-"+e]=new Ce(this.pusher,"private-encrypted-"+e,this.options)),this.channels["private-encrypted-"+e]}},{key:"presenceChannel",value:function(e){return this.channels["presence-"+e]||(this.channels["presence-"+e]=new Ne(this.pusher,"presence-"+e,this.options)),this.channels["presence-"+e]}},{key:"leave",value:function(e){var o=this,a=[e,"private-"+e,"private-encrypted-"+e,"presence-"+e];a.forEach(function(l,u){o.leaveChannel(l)})}},{key:"leaveChannel",value:function(e){this.channels[e]&&(this.channels[e].unsubscribe(),delete this.channels[e])}},{key:"socketId",value:function(){return this.pusher.connection.socket_id}},{key:"disconnect",value:function(){this.pusher.disconnect()}}]),n}(W),K=function(i){b(n,i);var s=g(n);function n(){var t;return d(this,n),t=s.apply(this,arguments),t.channels={},t}return p(n,[{key:"connect",value:function(){var e=this,o=this.getSocketIO();return this.socket=o(this.options.host,this.options),this.socket.on("reconnect",function(){Object.values(e.channels).forEach(function(a){a.subscribe()})}),this.socket}},{key:"getSocketIO",value:function(){if(typeof this.options.client<"u")return this.options.client;if(typeof io<"u")return io;throw new Error("Socket.io client not found. Should be globally available or passed via options.client")}},{key:"listen",value:function(e,o,a){return this.channel(e).listen(o,a)}},{key:"channel",value:function(e){return this.channels[e]||(this.channels[e]=new se(this.socket,e,this.options)),this.channels[e]}},{key:"privateChannel",value:function(e){return this.channels["private-"+e]||(this.channels["private-"+e]=new re(this.socket,"private-"+e,this.options)),this.channels["private-"+e]}},{key:"presenceChannel",value:function(e){return this.channels["presence-"+e]||(this.channels["presence-"+e]=new _e(this.socket,"presence-"+e,this.options)),this.channels["presence-"+e]}},{key:"leave",value:function(e){var o=this,a=[e,"private-"+e,"presence-"+e];a.forEach(function(l){o.leaveChannel(l)})}},{key:"leaveChannel",value:function(e){this.channels[e]&&(this.channels[e].unsubscribe(),delete this.channels[e])}},{key:"socketId",value:function(){return this.socket.id}},{key:"disconnect",value:function(){this.socket.disconnect()}}]),n}(W),Se=function(i){b(n,i);var s=g(n);function n(){var t;return d(this,n),t=s.apply(this,arguments),t.channels={},t}return p(n,[{key:"connect",value:function(){}},{key:"listen",value:function(e,o,a){return new T}},{key:"channel",value:function(e){return new T}},{key:"privateChannel",value:function(e){return new ie}},{key:"encryptedPrivateChannel",value:function(e){return new Pe}},{key:"presenceChannel",value:function(e){return new Ie}},{key:"leave",value:function(e){}},{key:"leaveChannel",value:function(e){}},{key:"socketId",value:function(){return"fake-socket-id"}},{key:"disconnect",value:function(){}}]),n}(W),Le=function(){function i(s){d(this,i),this.options=s,this.connect(),this.options.withoutInterceptors||this.registerInterceptors()}return p(i,[{key:"channel",value:function(n){return this.connector.channel(n)}},{key:"connect",value:function(){if(this.options.broadcaster=="reverb")this.connector=new X(O(O({},this.options),{cluster:""}));else if(this.options.broadcaster=="pusher")this.connector=new X(this.options);else if(this.options.broadcaster=="socket.io")this.connector=new K(this.options);else if(this.options.broadcaster=="null")this.connector=new Se(this.options);else if(typeof this.options.broadcaster=="function")this.connector=this.options.broadcaster(this.options);else throw new Error("Broadcaster ".concat(E(this.options.broadcaster)," ").concat(this.options.broadcaster," is not supported."))}},{key:"disconnect",value:function(){this.connector.disconnect()}},{key:"join",value:function(n){return this.connector.presenceChannel(n)}},{key:"leave",value:function(n){this.connector.leave(n)}},{key:"leaveChannel",value:function(n){this.connector.leaveChannel(n)}},{key:"leaveAllChannels",value:function(){for(var n in this.connector.channels)this.leaveChannel(n)}},{key:"listen",value:function(n,t,e){return this.connector.listen(n,t,e)}},{key:"private",value:function(n){return this.connector.privateChannel(n)}},{key:"encryptedPrivate",value:function(n){if(this.connector instanceof K)throw new Error("Broadcaster ".concat(E(this.options.broadcaster)," ").concat(this.options.broadcaster," does not support encrypted private channels."));return this.connector.encryptedPrivateChannel(n)}},{key:"socketId",value:function(){return this.connector.socketId()}},{key:"registerInterceptors",value:function(){typeof Vue=="function"&&Vue.http&&this.registerVueRequestInterceptor(),typeof axios=="function"&&this.registerAxiosRequestInterceptor(),typeof jQuery=="function"&&this.registerjQueryAjaxSetup(),(typeof Turbo>"u"?"undefined":E(Turbo))==="object"&&this.registerTurboRequestInterceptor()}},{key:"registerVueRequestInterceptor",value:function(){var n=this;Vue.http.interceptors.push(function(t,e){n.socketId()&&t.headers.set("X-Socket-ID",n.socketId()),e()})}},{key:"registerAxiosRequestInterceptor",value:function(){var n=this;axios.interceptors.request.use(function(t){return n.socketId()&&(t.headers["X-Socket-Id"]=n.socketId()),t})}},{key:"registerjQueryAjaxSetup",value:function(){var n=this;typeof jQuery.ajax<"u"&&jQuery.ajaxPrefilter(function(t,e,o){n.socketId()&&o.setRequestHeader("X-Socket-Id",n.socketId())})}},{key:"registerTurboRequestInterceptor",value:function(){var n=this;document.addEventListener("turbo:before-fetch-request",function(t){t.detail.fetchOptions.headers["X-Socket-Id"]=n.socketId()})}}]),i}();const Ee=({t:i,notification:s})=>{var n,t,e;return r.jsxs("div",{className:`${i.visible?"animate-enter":"animate-leave"} max-w-md w-full bg-white shadow-lg rounded-lg pointer-events-auto flex ring-1 ring-black ring-opacity-5`,children:[r.jsx("div",{className:"flex-1 w-0 p-4",children:r.jsxs("div",{className:"flex items-start",children:[r.jsx("div",{className:"flex-shrink-0 pt-0.5",children:r.jsx("img",{className:"h-10 w-10 rounded-full",src:(n=s==null?void 0:s.user)==null?void 0:n.photo,alt:"profile image"})}),r.jsxs("div",{className:"ml-3 flex-1",children:[r.jsx("p",{className:"text-sm font-medium text-gray-900",children:(t=s==null?void 0:s.user)==null?void 0:t.name}),r.jsx("p",{className:"mt-1 text-sm text-gray-500",children:(e=s==null?void 0:s.user)==null?void 0:e.mensaje})]})]})}),r.jsx("div",{className:"flex border-l border-gray-200",children:r.jsx("button",{onClick:()=>k.dismiss(i.id),className:"w-full border border-transparent rounded-none rounded-r-lg p-4 flex items-center justify-center text-sm font-medium text-indigo-600 hover:text-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500",children:"Cerrar"})})]})},Ae=()=>{const[i,s]=C.useState(null),n=ae(),{auth:t}=A().props,{url:e}=A();C.useEffect(()=>{var o;if(t!=null&&t.user){const a=new Le({broadcaster:"reverb",key:"9rncszhzfypiyds3wb1f",wsHost:"localhost",wsPort:"8080",wssPort:"8080",forceTLS:!1,enabledTransports:["ws","wss"]});s(a),a.private("users."+((o=t==null?void 0:t.user)==null?void 0:o.id)).notification(l=>{console.log(1),e.includes("chats")||k.custom(u=>r.jsx(Ee,{t:u,notification:l})),n.setQueryData([`chat.${l.chat_id}`],u=>{if(!u)return e==="/chats"&&n.invalidateQueries(["chats"]),u;const c=structuredClone(u.mensajes);return c.push(l.mensaje),{...u,mensajes:c}})})}return()=>{i==null||i.disconnect(),s(null)}},[t==null?void 0:t.user]),C.useEffect(()=>{t!=null&&t.user||i&&(i==null||i.disconnect(),s(null))},[t==null?void 0:t.user])};function Ge({children:i}){var f,_,P,I,S,w,y,m;const{loginModal:s,registerModal:n,setLoginModal:t,setRegisterModal:e}=xe(),[o,a]=$(!1),[l,u]=$(!1),{auth:c}=A().props;return C.useEffect(()=>{const x=j=>{j.origin===window.location.origin&&j.data==="auth-success"&&(L.reload(),k.success("Bienvenido"),e(!1),t(!1))};return window.addEventListener("message",x),()=>{window.removeEventListener("message",x)}},[]),C.useEffect(()=>{o===!0&&(c!=null&&c.user||t(!0))},[o]),Ae(),r.jsxs(r.Fragment,{children:[r.jsx(ce,{position:"top-center",reverseOrder:!1}),r.jsx(ve,{open:!!(o&&(c!=null&&c.user)),onClose:()=>a(!1)}),r.jsx(fe,{open:n,onClose:()=>e(!1),action:()=>{e(!1),t(!0)}}),r.jsx(de,{open:s,onClose:()=>t(!1),action:()=>{t(!1),e(!0)}}),r.jsx(ge,{open:!!(l&&(c!=null&&c.user)),onClose:()=>u(!1)}),r.jsxs("div",{className:"w-full h-screen flex flex-col",children:[r.jsxs("div",{className:"fixed flex justify-between items-center top-0 right-0 px-6 py-2 text-right z-10 bg-white w-full",children:[r.jsx(D,{href:"/",children:r.jsx(le,{className:"block h-9 w-auto fill-current text-gray-800"})}),r.jsx(D,{href:"/mascotas",className:"ml-4 font-semibold text-custom-beige hover:text-gray-900 dark:text-custom-beige dark:hover:text-gray-600 focus:outline focus:outline-2 focus:rounded-sm",children:"Mascotas"}),r.jsx("a",{href:"",className:"ml-4 font-semibold text-custom-beige hover:text-gray-900 dark:text-custom-beige dark:hover:text-gray-600 focus:outline focus:outline-2 focus:rounded-sm",children:"Organizaciones"}),r.jsx(D,{href:"/contactanos",className:"ml-4 font-semibold text-custom-beige hover:text-gray-900 dark:text-custom-beige dark:hover:text-gray-600 focus:outline focus:outline-2 focus:rounded-sm",children:"Contacto"}),r.jsx("button",{type:"button",className:"hidden md:block font-bold text-gray-700 border border-gray-400 p-2 rounded-full",onClick:()=>a(!0),children:"Dar en adopción"}),r.jsx("button",{type:"button",className:"hidden md:block font-bold text-gray-700 border border-gray-400 p-2 rounded-full",onClick:()=>u(!0),children:"Reportar extravío"}),r.jsx("div",{className:"hidden md:block",children:r.jsxs(v,{children:[r.jsx(v.Trigger,{children:c!=null&&c.user?(f=c==null?void 0:c.user)!=null&&f.photo?r.jsx("img",{src:(_=c==null?void 0:c.user)==null?void 0:_.photo,alt:"profile image",className:"rounded-full w-10 h-10 cursor-pointer"}):r.jsx("div",{className:"bg-blue-500 text-white font-bold flex justify-center items-center rounded-full w-10 h-10 cursor-pointer",children:(I=(P=c==null?void 0:c.user)==null?void 0:P.name)==null?void 0:I.charAt(0)}):r.jsx("img",{src:"/imagenes/blank_profile.png",alt:"profile image",className:"rounded-full w-10 h-10 cursor-pointer"})}),r.jsx(v.Content,{children:c!=null&&c.user?r.jsxs(r.Fragment,{children:[r.jsx(v.Link,{href:route("profile.edit"),children:"Perfil"}),r.jsx(v.Link,{href:route("logout"),method:"post",as:"button",children:"Cerrar sesión"}),r.jsx(v.Link,{href:"/myadoptions",children:"Mis mascotas"}),r.jsx(v.Link,{href:"/chats",children:"Mensajes"})]}):r.jsxs(r.Fragment,{children:[r.jsx("button",{type:"button",className:"block w-full px-4 py-2 text-start text-sm leading-5 text-gray-700 hover:bg-gray-100 focus:outline-none focus:bg-gray-100 transition duration-150 ease-in-out",onClick:()=>t(!0),children:"Iniciar sesión"}),r.jsx("button",{type:"button",className:"block w-full px-4 py-2 text-start text-sm leading-5 text-gray-700 hover:bg-gray-100 focus:outline-none focus:bg-gray-100 transition duration-150 ease-in-out",onClick:()=>e(!0),children:"Registrarse"})]})})]})})]}),r.jsx("main",{className:"mt-20 pb-4 flex-1 overflow-y-auto",children:i}),r.jsx("div",{className:"block md:hidden w-full h-auto bg-white shadow-md",children:r.jsxs("div",{className:"flex justify-around py-4",children:[r.jsxs("div",{className:"flex flex-col items-center cursor-pointer",onClick:()=>a(!0),children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 7V3m8 4V3m-7 6a4 4 0 00-8 0v7h16v-7a4 4 0 00-8 0z"})}),r.jsx("span",{className:"text-xs text-gray-700",children:"Dar en adopción"})]}),r.jsxs("div",{className:"flex flex-col items-center cursor-pointer",children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})}),r.jsx("span",{className:"text-xs text-gray-700",children:"Reportar extravío"})]}),r.jsxs(v,{children:[r.jsx(v.Trigger,{children:c!=null&&c.user?(S=c==null?void 0:c.user)!=null&&S.photo?r.jsx("img",{src:(w=c==null?void 0:c.user)==null?void 0:w.photo,alt:"profile image",className:"rounded-full w-10 h-10 cursor-pointer"}):r.jsx("div",{className:"bg-blue-500 text-white font-bold flex justify-center items-center rounded-full w-10 h-10 cursor-pointer",children:(m=(y=c==null?void 0:c.user)==null?void 0:y.name)==null?void 0:m.charAt(0)}):r.jsx("img",{src:"/imagenes/blank_profile.png",alt:"profile image",className:"rounded-full w-10 h-10 cursor-pointer"})}),r.jsx(v.Content,{position:"buttom",children:c!=null&&c.user?r.jsxs(r.Fragment,{children:[r.jsx(v.Link,{href:route("profile.edit"),children:"Perfil"}),r.jsx(v.Link,{href:route("logout"),method:"post",as:"button",children:"Cerrar sesión"}),r.jsx(v.Link,{href:"/myadoptions",children:"Mis mascotas"}),r.jsx(v.Link,{href:"/chats",children:"Mensajes"})]}):r.jsxs(r.Fragment,{children:[r.jsx("button",{type:"button",className:"block w-full px-4 py-2 text-start text-sm leading-5 text-gray-700 hover:bg-gray-100 focus:outline-none focus:bg-gray-100 transition duration-150 ease-in-out",onClick:()=>t(!0),children:"Iniciar sesión"}),r.jsx("button",{type:"button",className:"block w-full px-4 py-2 text-start text-sm leading-5 text-gray-700 hover:bg-gray-100 focus:outline-none focus:bg-gray-100 transition duration-150 ease-in-out",onClick:()=>e(!0),children:"Registrarse"})]})})]})]})})]})]})}export{Ge as G,ee as L,xe as u};
